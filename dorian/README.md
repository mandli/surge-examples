# Hurricane Dorian

Tropical storm Dorian formed in the Atlantic on 24 August 2019 and made landfall in Barbados on 27 August 2019. Dorian then moved through the U.S. Virgin Islands and Puerto Rico, finding a region of "warm ocean" and "abundant atmospheric moisture," which encouraged the storm's escalation to a category 5 hurricane. Dorian made landfall in the Bahamas on 1 September 2019, inflicting historic damage, before weakening and making its way up the eastern coast of Florida. Dorian gained stength past Florida, moved to Georgia, South Carolina, North Carolina, and then further north, eventually dissapating in the Atlantic on 8 September 2019.

Source: <https://www.nhc.noaa.gov/data/tcr/AL052019_Dorian.pdf>

## Storm Data

Storm data can be found on NOAA's storm data archive: <https://ftp.nhc.noaa.gov/atcf/archive/2019/bal052019.dat.gz>.

## Topography/Bathymetry Data

To use topography data, it must first be converted into the correct format. To get ETOPO1 data, run the python code below in a directory of your choice (this directory must be referenced in the topography section of `setrun.py`). This code gathers one arc-minute resolution ETOPO1 data in NetCDF format from the coordinate bounds specified in the `extent` variable and then writes the data out to an ASCII file:

```python
from clawpack.geoclaw import topsotools

# longitude/latitude range covering Florida
extent = [-86,-62,18,46]

# specifies ETOPO1 data
path = 'etopo1'

# reads in the ETOPO1 data in NetCDF format
topo = topotools.read_netcdf(path, extent=extent, verbose=True)

# to save topofile for input to GeoClaw: 
topo.write('etopo_sample_1min.tt3', topo_type=3, Z_format='%.0f')
```

To get more precise data, you can download a three arc-second topography file of a similar area in NetCDF format from here: <https://www.ngdc.noaa.gov/mgg/coastal/grddas03/grddas03.htm>.

## Geoclaw Results

The Clawpack simulation, which ran from 4 September 2019 (two days before landfall in Florida) to 9 September 2019 (three days after landfall), predicted storm surges ranging from 0-1 meters. The plots generated by `setplot.py` include NOAA tide data in green and Clawpack data in blue. In most cases, Clawpack does a good job at predicting storm surge heights (off by a foot at most) and times.

## Validation Results

If you would like more control over the plotting of validation data, you may gather the data yourself using the NOAA Tides and Currents CO-OPS API For Data Retrieval (<https://api.tidesandcurrents.noaa.gov/api/prod/>). This data can also be retrieved manually through the search function on the NOAA Tides and Currents Website (<https://tidesandcurrents.noaa.gov/map/index.html>). The code below plots the difference between predicted and validated water levels at specified gauge locations along the east coast using the API (best run in a Jupyter Notebook for easy modification and visualization). These graphs should mirror the green lines plotted by `setplot.py`.

```python
import pandas as pd
from matplotlib import pyplot as plt

# set station ids (#######) and date ranges (yyyymmdd)
station_ids = ['8721604', '8722670', '8720218', '8720030', '8670870', '8665530', '8661070', '8656483']
begin_date = "20190824"
end_date = "20190909"

'''
Plots the difference between predicted and verified water levels at
specified noaa gauges. Set the values above to plot.
'''
def plot_water_diff_api(station_id):
    
    # get verified water height
    url = 'https://api.tidesandcurrents.noaa.gov/api/prod/datagetter?product=water_level&application=NOS.COOPS.TAC.WL&begin_date=' + begin_date + '&end_date=' + end_date + '&datum=MLLW&station=' + station_id + '&time_zone=GMT&units=english&format=csv'
    data = pd.read_csv(url)
    verified = data.iloc[:, 1]

    # get predicted water height
    url = 'https://api.tidesandcurrents.noaa.gov/api/prod/datagetter?product=predictions&application=NOS.COOPS.TAC.WL&begin_date=' + begin_date + '&end_date=' + end_date + '&datum=MLLW&station=' + station_id + '&time_zone=GMT&units=english&interval=&format=csv'
    data = pd.read_csv(url)
    predicted = data.iloc[:, 1]

    # create new dataframe
    diff = verified - predicted
    date = data.iloc[:, 0]
    frame = {'Difference (ft)': diff, 'Date': date}
    result = pd.DataFrame(frame)
    
    # plot the results
    ax = result.plot(x = 'Date', y = 'Difference (ft)', 
                     title='Difference: Verified vs. Predicted Water Height (' + station_id + ')', 
                     figsize=(15, 5))
    ax.set(xlabel='Date', ylabel='Difference (ft)')
    plt.show()
    
for station_id in station_ids:
    plot_water_diff_api(station_id)
```

## Conclusion

Simulations performed at lower refinement levels (3-4) for gauges 1, 2, and 5-8 predict storm surge heights to within a foot of actual data and times to within a few hours of actual data. Results from gauges 3 and 4 are harder to gather as they are located further inland. For these, refinement levels must be higher to register water and not land.